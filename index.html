<!DOCTYPE html>
<html>
<head>
	<title>Movies Hangman</title>
	<link href='https://fonts.googleapis.com/css?family=Bilbo+Swash+Caps' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<link rel="stylesheet" type="text/css" href="assets/css/reset.css">
	<link rel="stylesheet" type="text/css" href="assets/css/style.css">
	<script type="text/javascript" src="https://code.jquery.com/jquery-2.2.0.min.js"></script>
</head>
<body>
	<header>
		<div class="header">
			<h1>Hangman: Movies</h1>
		</div>
	</header>
	<div class="container">
		<div class="row">
			<div class="col-md-5" id="answerimage">
				<div id="answer">
				</div>
				<div class="display-text">
					<p id="movie"></p>
				</div>
			</div>
			<div class="col-md-2"></div>
			<div class="col-md-5" id="playspace">
				
			</div>
		</div>
		<div class="row">
			<div class="col-md-12">
				<div>
					<img src="assets/images/admitone.png" id="admitone">
					<p id="any-key">Press any key to<br>get started!</p>
				</div>
			</div>
		</div>
	</div>
	<script type="text/javascript">
		var game = {
			wins: 0,
			currentWord: "",
			under: [],
			movies: ["avatar", "the_dark_knight", "man_of_steel", "the_silence_of_the_lambs", "star_wars", "captain_america", "titanic", "the_last_airbender", "skyfall", "jurassic_park", "goodfellas", "looper", "ghostbusters", "men_in_black", "pulp_fiction", "the_lion_king", "shutter_island"],
			moviesDisplay: ["Avatar", "The Dark Knight", "Man of Steel", "The Silence of the Lambs", "Star Wars", "Captain America", "Titanic", "The Last Airbender", "Skyfall", "Jurassic Park", "Goodfellas", "Looper", "Ghostbusters", "Men in Black", "Pulp Fiction", "The Lion King", "Shutter Island"],
			guessesRemaining: 10,
			lettersGuessed: "",
			movieNum: "",
			movie: "",
			movieDisplay: "",
			image: "",
			found: false,
			firstGame: true,
			start : function(){
        this.wins = 0;
        this.firstGame = true;
        this.newGame();
      },
      newGame : function(){
      	$("#answer").html('<img src="assets/images/placeholder.png" id="result">');
      	var answer = document.getElementById("movie");
      	answer.innerHTML = "";
      	parent.innerHTML = this.image;
      	this.guessesRemaining = 10;
      	this.lettersGuessed = "";
      	this.under = [];
      	this.currentWord = "";
      	this.movieNum = "";
      	this.movie = "";
      	this.movieDisplay = "";
        this.currentWord = this.getRandomMovie();
      	this.newWordDisplay(this.currentWord);
      },
      getRandomMovie : function(){
      	this.movieNum = Math.floor(Math.random() * (this.movies.length - 1));
      	this.movie = this.movies[this.movieNum];
      	return this.movie;
      },
      newWordDisplay : function(word){
	      under = [];
	      for(var i = 0; i < word.length; i++)
	      {
	      	if(word[i]=="_")
	      	{
	      		this.under.push(" - ");
	      	}
	      	else
	      	{
	      		this.under.push(" _");
	      	}
	      }
	      for(var j = 0; j < this.under.length; j++)
	      {
	      	this.movieDisplay = this.movieDisplay + this.under[j] + " ";
	      }
		    var html = '<p class="display-text" id="Under">Current Word:<br><br>'
		    html = html + this.movieDisplay + '</p><p class="display-text" id="wins">Wins: ' + this.wins + '</p><p class="display-text" id="Guesses">Guesses Remaining: ' + this.guessesRemaining + '</p><p class="display-text" id="Letters">Letters Guessed: <br>' + this.lettersGuessed + '<br></p>';
		    var el = document.getElementById("playspace");
		    el.innerHTML = html;
	      this.updateUnder(this.movieDisplay);
      },
      guess : function(letter){
      	if(this.guessesRemaining==1)
      	{
	      	this.lose();
	      }
	      else
	      {
	      	if(this.lettersGuessed=="")
	      	{
	      		this.lettersGuessed += letter;
	      	}
	      	else
	      	{
	      		this.lettersGuessed = this.lettersGuessed + ', ' + letter;
	      	}
	      	for(var i = 0; i < this.currentWord.length; i++)
	      	{
	      		if(letter == this.currentWord[i])
	      		{
	      			this.found=true;
	      			this.under[i]=letter;
	      			this.updateUnder(this.under);
	      		}
	      	}
	      	if(!this.found){
	      		this.guessesRemaining--;
	      		this.updateGuessesRemaining(this.guessesRemaining);
	      	}
	      	this.updateLettersGuessed(this.lettersGuessed);
	      	var sum = 0;
	      	for(var j = 0; j < this.currentWord.length; j++)
	      	{
	      		if(this.under[j] == this.currentWord[j] || this.under[j] == " - ")
	      		{
	      			sum++;
	      		}
	      	}
	      	console.log(this.movieDisplay);
	      	console.log(this.movie);
	      	console.log(sum);
	      	if(sum == this.currentWord.length)
	      	{
	      		this.win();
	      	}
	      }
	      this.found = false;
      },
      updateUnder : function(newUnder){
      	var underEl = document.getElementById("Under");
      	this.movieDisplay = "";
      	for(var j = 0; j < newUnder.length; j++)
	      {
	      	this.movieDisplay = this.movieDisplay + newUnder[j] + " ";
	      }
      	underEl.innerHTML = 'Current Word:<br><br>' + this.movieDisplay;
      },
      updateGuessesRemaining: function(newGuessesRemaining){
      	var guessesEl = document.getElementById("Guesses");
      	guessesEl.innerHTML = 'Guesses Remaining: ' + newGuessesRemaining;
      },
      updateLettersGuessed: function(newLettersGuessed){
      	var lettersEl = document.getElementById("Letters");
      	lettersEl.innerHTML = 'Letters Guessed: <br>' + newLettersGuessed;
      },
      updateWins: function(newWins){
      	var winsEl = document.getElementById("wins");
      	winsEl.innerHTML = 'Wins: ' + newWins;
      },
      win: function(){
      	var movieName = document.getElementById("movie");
      	var poster = this.movieNum;
      	var display = this.moviesDisplay[this.movieNum];
      	movieName.innerHTML = display;
      	this.wins++;
      	this.updateWins(this.wins);
      	alert("You win!");
      	game.newGame()
      },
      lose: function(){
      	alert("You lose!");
      	game.newGame();
      }
		};
		document.onload = game.start();
		document.onkeyup = function(event) {
				var userGuess = String.fromCharCode(event.keyCode).toLowerCase();
				game.guess(userGuess);
				console.log(userGuess);
		}
	</script>
</body>
</html>